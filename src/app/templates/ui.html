<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FlaskApp</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <style>
        textarea.textarea-autosize {
            height: 2.25rem;
            min-height: 2.25rem;
            resize: none;
            overflow-y:hidden;
        }

        textarea.textarea-autosize.form-control-lg {
            height: 3.75rem;
            min-height: 3.75rem;
        }

        textarea.textarea-autosize.form-control-sm {
            height: 2rem;
            min-height: 2rem;
        }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
</head>
<body>
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <div class="container" style="height: 120%">
        <div class="row my-4">
            <div class="col">
                <div class="jumbotron">
                    <div class="floating-label">
                        <label for="prompt">Enter prompt here.</label>
                        <textarea class="form-control textarea-autosize" id="prompt" rows="1"></textarea>
                    </div>
                    <button  class="btn btn-primary" id="submit" type="submit" value = "submit">Submit</button>
                </div>
            </div>
        </div>
    </div>
    <h3>Response</h3>
    <p id="response"></p>
</body>

<script>
    var btn = document.getElementById("submit");

    btn.addEventListener('click', function(event) {
        event.preventDefault();
        const input = document.getElementById("prompt").value;
        const wrappedInput = {"instances":[input]}
        fetch('/infer', {
            method: 'POST',
            body: JSON.stringify(wrappedInput),
            headers: {
                "Content-Type": "application/json",
            },
            cache: "no-cache",
        })
        .then((response) => response.json())
        .then(function(json) {
            console.log(json);
            document.getElementById("response").innerText = JSON.stringify(json);
        });
    });
</script>

<script>
/*!
 * jQuery Textarea AutoSize plugin : https://github.com/javierjulio/textarea-autosize
 * Author: Javier Julio
 * Licensed under the MIT license
 */
!function(t,e,i,n){function s(e,i){this.element=e,this.$element=t(e),this.init()}var h="textareaAutoSize",o="plugin_"+h,r=function(t){return t.replace(/\s/g,"").length>0};s.prototype={init:function(){var i=parseInt(this.$element.css("paddingBottom"))+parseInt(this.$element.css("paddingTop"))+parseInt(this.$element.css("borderTopWidth"))+parseInt(this.$element.css("borderBottomWidth"))||0;r(this.element.value)&&this.$element.height(this.element.scrollHeight-i),this.$element.on("input keyup",function(n){var s=t(e),h=s.scrollTop();t(this).height(0).height(this.scrollHeight-i),s.scrollTop(h)})}},t.fn[h]=function(e){return this.each(function(){t.data(this,o)||t.data(this,o,new s(this,e))}),this}}(jQuery,window,document);

// Initialize Textarea
$('.textarea-autosize').textareaAutoSize();
</script>